---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .env.example
  - .gitignore
autonomous: false
requirements: []
user_setup:
  - service: azure-openai
    why: "Chat completion endpoint for natural language queries"
    env_vars:
      - name: AZURE_OPENAI_ENDPOINT
        source: "Azure Portal > Resource Group > OpenAI resource > Keys and Endpoint"
      - name: AZURE_OPENAI_API_KEY
        source: "Azure Portal > Resource Group > OpenAI resource > Keys and Endpoint"
    dashboard_config:
      - task: "Create Azure OpenAI resource in East US 2"
        location: "Azure Portal > Create a resource > Azure OpenAI"
      - task: "Deploy gpt-4o model"
        location: "Azure AI Foundry > Deployments > Deploy base model"
      - task: "Create custom content filter (High only thresholds)"
        location: "Azure AI Foundry > Guardrails + controls > Content filters"
      - task: "Submit content filter modification request"
        location: "https://ncv.microsoft.com/uEfCgnITdR"
  - service: microsoft-sentinel
    why: "Live SIEM data queries for security incidents and alerts"
    env_vars:
      - name: SENTINEL_WORKSPACE_ID
        source: "Azure Portal > Log Analytics workspace > Overview > Workspace ID"
    dashboard_config:
      - task: "Create Log Analytics workspace and enable Sentinel"
        location: "Azure Portal > Microsoft Sentinel > Create"
      - task: "Install Sentinel Training Lab for sample data"
        location: "Microsoft Sentinel > Content Hub > Microsoft Sentinel Training Lab"

must_haves:
  truths:
    - "Azure OpenAI resource exists in East US 2 with gpt-4o deployment"
    - "Custom content filter with High-only thresholds is applied to gpt-4o deployment"
    - "Content filter modification request has been submitted"
    - "Sentinel workspace exists with Training Lab sample data ingested"
    - ".env file exists with real Azure resource values"
    - ".env.example documents all variables with Azure Portal locations"
    - ".gitignore prevents .env and other secrets from being committed"
  artifacts:
    - path: ".env.example"
      provides: "Template for all environment variables grouped by service"
      contains: "AZURE_OPENAI_ENDPOINT"
    - path: ".gitignore"
      provides: "Git ignore rules for secrets and Python artifacts"
      contains: ".env"
  key_links:
    - from: ".env.example"
      to: ".env"
      via: "Developer copies and fills in real values"
      pattern: "AZURE_OPENAI_ENDPOINT"
---

<objective>
Create the developer setup files (.env.example, .gitignore) and guide the user through Azure resource provisioning: Azure OpenAI resource with gpt-4o deployment, custom content filter configuration, content filter modification request submission, Sentinel workspace with Training Lab data, and populating .env with real values.

Purpose: Unblock all subsequent development by establishing Azure infrastructure and ensuring developers know where to find credentials.
Output: .env.example, .gitignore, provisioned Azure resources, populated .env file
</objective>

<execution_context>
@C:/Users/AlexSandstrom/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/AlexSandstrom/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create .env.example and .gitignore</name>
  <files>.env.example, .gitignore</files>
  <action>
Create `.env.example` with all environment variables grouped by service with inline comments explaining each variable and where to find the values in Azure portal. Follow the exact template from the research document (01-RESEARCH.md ".env.example Template" section). Groups: Azure OpenAI Configuration, Microsoft Sentinel / Log Analytics, Azure Authentication. Include commented-out future-phase variables (embedding deployment, ChromaDB path) with phase annotations. Include the warning about NOT setting AZURE_TENANT_ID/AZURE_CLIENT_ID/AZURE_CLIENT_SECRET for local development per the DefaultAzureCredential gotcha.

Create `.gitignore` with rules for:
- `.env` (secrets)
- `__pycache__/`, `*.pyc`, `*.pyo` (Python bytecode)
- `.venv/`, `venv/`, `env/` (virtual environments)
- `data/chroma_db/` (Phase 4 vector store data)
- `.pytest_cache/` (pytest cache)
- `.ruff_cache/` (ruff cache)
- `*.egg-info/`, `dist/`, `build/` (packaging artifacts)
- `.idea/`, `.vscode/` (IDE settings)
  </action>
  <verify>Confirm both files exist, .env.example contains all three service groups with portal location comments, .gitignore covers .env and Python artifacts.</verify>
  <done>.env.example has AZURE_OPENAI_ENDPOINT, AZURE_OPENAI_API_KEY, SENTINEL_WORKSPACE_ID with portal location comments. .gitignore has .env and __pycache__ rules.</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <name>Task 2: Provision Azure resources and populate .env</name>
  <files>.env</files>
  <action>
Present the user with the Azure resource provisioning guide. The full step-by-step guide is in `.planning/phases/01-foundation/01-RESEARCH.md` under "Azure Resource Provisioning Guide". Summarize the 8 steps below and pause for the user to complete them.

**Step 1: Create Azure OpenAI Resource**
- Azure Portal > Create a resource > "Azure OpenAI"
- Region: East US 2 (required for gpt-4o availability)
- Resource group: rg-sentinel-chatbot (or preferred name)
- Pricing: Standard S0
- Or CLI: `az group create --name rg-sentinel-chatbot --location eastus2` then `az cognitiveservices account create --name oai-sentinel-chatbot --resource-group rg-sentinel-chatbot --location eastus2 --kind OpenAI --sku s0 --custom-domain oai-sentinel-chatbot`

**Step 2: Deploy gpt-4o Model**
- Azure AI Foundry (ai.azure.com) > Your resource > Deployments > Deploy base model
- Select gpt-4o, deployment name: "gpt-4o", type: Standard
- Or CLI: `az cognitiveservices account deployment create --name oai-sentinel-chatbot --resource-group rg-sentinel-chatbot --deployment-name gpt-4o --model-name gpt-4o --model-version "2024-11-20" --model-format OpenAI --sku-capacity "1" --sku-name "Standard"`

**Step 3: Create Custom Content Filter**
- Azure AI Foundry > Guardrails + controls > Content filters > Create content filter
- Name: "security-permissive"
- Set ALL four harm categories to "High only" for both input and output
- Associate with the gpt-4o deployment (no approval needed)

**Step 4: Submit Content Filter Modification Request**
- Navigate to: https://ncv.microsoft.com/uEfCgnITdR
- Use case description: "Security operations chatbot querying Microsoft Sentinel SIEM data. Requires processing security incident descriptions, MITRE ATT&CK technique names, malware descriptions, and phishing content for legitimate SOC analyst workflows."
- Submit (approval 1-3 business days; High-only filter from Step 3 is the fallback)

**Step 5: Create Sentinel Workspace**
- Azure Portal > Microsoft Sentinel > Create > new Log Analytics workspace in same region
- After creation, select workspace and click "Add" to enable Sentinel

**Step 6: Deploy Sentinel Training Lab**
- In Sentinel > Content Hub > search "Microsoft Sentinel Training Lab" > Install
- Wait 5-10 minutes, verify: `SecurityIncident | count` returns > 0

**Step 7: Get Credentials and Create .env**
- Copy `.env.example` to `.env`, fill in AZURE_OPENAI_ENDPOINT, AZURE_OPENAI_API_KEY, SENTINEL_WORKSPACE_ID
- Run `az login` for DefaultAzureCredential

**Step 8: Verify credentials populated**
- Confirm .env has all three required values (not placeholders)

Resume signal: Type "done" when complete or describe issues.
  </action>
  <verify>Confirm .env file exists with AZURE_OPENAI_ENDPOINT, AZURE_OPENAI_API_KEY, and SENTINEL_WORKSPACE_ID set to non-placeholder values. Confirm `az login` has been run.</verify>
  <done>.env exists with real Azure resource values. Azure OpenAI resource has gpt-4o deployment with custom content filter. Content filter modification request submitted. Sentinel workspace has Training Lab data. User is logged in via az login.</done>
</task>

</tasks>

<verification>
- .env.example exists with all variables documented
- .gitignore exists with .env and Python artifact rules
- .env exists with real Azure values (after human action)
- Content filter modification request has been submitted
</verification>

<success_criteria>
- .env.example has all Phase 1 variables with Azure Portal location comments
- .gitignore prevents .env from being committed
- Azure OpenAI resource exists with gpt-4o deployment and custom content filter
- Content filter modification request submitted at ncv.microsoft.com
- Sentinel workspace exists with Training Lab sample data
- .env contains real AZURE_OPENAI_ENDPOINT, AZURE_OPENAI_API_KEY, SENTINEL_WORKSPACE_ID values
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
